<html>
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.css" />
        <link rel="stylesheet" href="css/style1.css">
    </head>
    <body style='border:0; margin: 0'>
        <div id='map'></div>
        <div class="searchBar">
            <form id="form">
                <input type="text" name="end" class="SearchInput" id="destination" placeholder="Choose ending point" />
                <button class="searchButton" type="submit"></button>
            </form>
        </div>
		<div class="results" id="ResultTableContainer">
            <div class="ResultsTable">
                <table id="nearBikeResultTable"  cellspacing="0" cellpadding="0">
				</table>
            </div>
		</div>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.js"></script>
        <script src="https://www.mapquestapi.com/sdk/leaflet/v2.2/mq-map.js?key=S8d7L47mdyAG5nHG09dUnSPJjreUVPeC"></script>
        <script src="https://www.mapquestapi.com/sdk/leaflet/v2.2/mq-routing.js?key=S8d7L47mdyAG5nHG09dUnSPJjreUVPeC"></script>
        <script   src="./index.cjs"></script>
        <script src="./bundle.js"></script>
        <script src="https://cdn.socket.io/4.5.3/socket.io.min.js" integrity="sha384-WPFUvHkB1aHA5TDSZi6xtDgkF0wXJcIIxXhC6h8OT8EH3fC5PWro5pWJ1THjcfEi" crossorigin="anonymous"></script>

        <script>

            const socket = io("http://10.21.11.214:4000", {
                withCredentials: true
                });
                var ResultTable= document.getElementById("nearBikeResultTable");
                socket.on('sendBikesResult', (msg) => {
                    //console.log('message: ' + msg[0]['ID']+msg[0]['img_src']);
                    var enc = new TextDecoder("utf-8");
                    //console.log(msg.length);
                    //create data block for each bike
                    for (var i=0;i<msg.length;i++){
                        var image= new Image();
                        //decode image and put it as source
                        image.src = 'data:image/png;base64,'+enc.decode(msg[i]['img_src']);
                        image.style.height="50%";
                        image.style.width="50%";
                        //insert in result table
                        var row = ResultTable.insertRow(i);
                        var cell = row.insertCell(0);
                        cell.appendChild(image);
                    }
                });
            socket.emit("TEST","ciao da applicazione android!");

        </script>
    </body>
</html>